使得多个进程可以访问同一块内存空间，是最快的可用IPC形式。是针其他通信机制运行效率较低设计的。往往与其它通信机制，如信号量结合使用， 来达到进程间的同步及互斥。

* 写共享内存  
```c

Xshell 6 (Build 0101)
Copyright (c) 2002 NetSarang Computer, Inc. All rights reserved.

Type `help' to learn how to use Xshell prompt.
[D:\~]$ 

Connecting to 192.168.142.128:22...
Could not connect to '192.168.142.128' (port 22): Connection failed.

Type `help' to learn how to use Xshell prompt.
[D:\~]$ 

Connecting to 192.168.142.128:22...
Could not connect to '192.168.142.128' (port 22): Connection failed.

Type `help' to learn how to use Xshell prompt.
[D:\~]$ 

Connecting to 192.168.142.128:22...
Connection established.
To escape to local shell, press 'Ctrl+Alt+]'.

Last login: Mon Jul 15 21:22:37 2019 from 192.168.142.1
[pingz@localhost ~]$ clear
[pingz@localhost ~]$ ls
apache-tomcat-9.0.20-src         code          httpd-2.4.39.tar.gz  模板  图片  下载  桌面
apache-tomcat-9.0.20-src.tar.gz  httpd-2.4.39  公共                 视频  文档  音乐
[pingz@localhost ~]$ ll
总用量 14564
drwxrwxr-x. 10 pingz pingz    4096 5月  29 00:43 apache-tomcat-9.0.20-src
-rwxrw-rw-.  1 pingz pingz 5702073 5月  28 21:42 apache-tomcat-9.0.20-src.tar.gz
drwxrwxr-x.  3 pingz pingz     178 7月  14 22:24 code
drwxr-xr-x. 11 pingz pingz    4096 5月  28 23:02 httpd-2.4.39
-rwxrw-rw-.  1 pingz pingz 9199150 5月  28 22:16 httpd-2.4.39.tar.gz
drwxr-xr-x.  2 pingz pingz       6 4月   6 10:23 公共
drwxr-xr-x.  2 pingz pingz       6 4月   6 10:23 模板
drwxr-xr-x.  2 pingz pingz       6 4月   6 10:23 视频
drwxr-xr-x.  2 pingz pingz       6 4月   6 10:23 图片
drwxr-xr-x.  2 pingz pingz       6 4月   6 10:23 文档
drwxr-xr-x.  2 pingz pingz       6 4月   6 10:23 下载
drwxr-xr-x.  2 pingz pingz       6 4月   6 10:23 音乐
drwxr-xr-x.  2 pingz pingz       6 5月  28 23:01 桌面
[pingz@localhost ~]$ cd code
[pingz@localhost code]$ ll
总用量 72
drwxrwxr-x. 4 pingz pingz    39 6月  24 23:36 fa
-rw-rw-r--. 1 pingz pingz    45 6月  24 23:37 fa.tar.gz
-rwxrwxr-x. 1 pingz pingz 10520 7月  14 22:24 hash
-rw-rw-r--. 1 pingz pingz  1943 7月  14 22:24 hash.c
-rw-rw-r--. 1 pingz pingz  6272 7月  14 22:24 hash.o
-rwxrwxr-x. 1 pingz pingz  9056 7月   7 15:15 main
-rw-------. 1 pingz pingz  1420 7月   7 15:15 main.c
-rwxrwxr-x. 1 pingz pingz 11408 6月  23 16:22 multithread
-rw-rw-r--. 1 pingz pingz  1188 6月  23 16:22 multithread.c
-rw-rw-r--. 1 pingz pingz  7624 6月  23 16:22 multithread.o
-rwxrwxr-x. 1 pingz pingz   190 6月  24 23:33 package.sh
[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ gcc -o shm_w shm_w.c 
[pingz@localhost code]$ ./shm_w 
create shard memeory success
[pingz@localhost code]$ ll
总用量 92
drwxrwxr-x. 4 pingz pingz    39 6月  24 23:36 fa
-rw-rw-r--. 1 pingz pingz    45 6月  24 23:37 fa.tar.gz
-rwxrwxr-x. 1 pingz pingz 10520 7月  14 22:24 hash
-rw-rw-r--. 1 pingz pingz  1943 7月  14 22:24 hash.c
-rw-rw-r--. 1 pingz pingz  6272 7月  14 22:24 hash.o
-rwxrwxr-x. 1 pingz pingz  9056 7月   7 15:15 main
-rw-------. 1 pingz pingz  1420 7月   7 15:15 main.c
-rwxrwxr-x. 1 pingz pingz 11408 6月  23 16:22 multithread
-rw-rw-r--. 1 pingz pingz  1188 6月  23 16:22 multithread.c
-rw-rw-r--. 1 pingz pingz  7624 6月  23 16:22 multithread.o
-rwxrwxr-x. 1 pingz pingz   190 6月  24 23:33 package.sh
-rw-rw-r--. 1 pingz pingz     4 7月  21 00:04 shared_data
-rwxrwxr-x. 1 pingz pingz  9056 7月  21 00:04 shm_w
-rw-rw-r--. 1 pingz pingz  1011 7月  21 00:04 shm_w.c
[pingz@localhost code]$ cat shared_data 
[pingz@localhost code]$ vim sh
shared_data  shm_w        shm_w.c      
[pingz@localhost code]$ vim shared_data 
[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ gdb ./shm_w.c
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-redhat-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
"/home/pingz/code/./shm_w.c": not in executable format: 不可识别的文件格式
(gdb) ll
Undefined command: "ll".  Try "help".
(gdb) l
No symbol table is loaded.  Use the "file" command.
(gdb) l
No symbol table is loaded.  Use the "file" command.
(gdb) q
[pingz@localhost code]$ ll
总用量 92
drwxrwxr-x. 4 pingz pingz    39 6月  24 23:36 fa
-rw-rw-r--. 1 pingz pingz    45 6月  24 23:37 fa.tar.gz
-rwxrwxr-x. 1 pingz pingz 10520 7月  14 22:24 hash
-rw-rw-r--. 1 pingz pingz  1943 7月  14 22:24 hash.c
-rw-rw-r--. 1 pingz pingz  6272 7月  14 22:24 hash.o
-rwxrwxr-x. 1 pingz pingz  9056 7月   7 15:15 main
-rw-------. 1 pingz pingz  1420 7月   7 15:15 main.c
-rwxrwxr-x. 1 pingz pingz 11408 6月  23 16:22 multithread
-rw-rw-r--. 1 pingz pingz  1188 6月  23 16:22 multithread.c
-rw-rw-r--. 1 pingz pingz  7624 6月  23 16:22 multithread.o
-rwxrwxr-x. 1 pingz pingz   190 6月  24 23:33 package.sh
-rw-rw-r--. 1 pingz pingz     4 7月  21 00:04 shared_data
-rwxrwxr-x. 1 pingz pingz  9056 7月  21 00:04 shm_w
-rw-rw-r--. 1 pingz pingz  1011 7月  21 00:04 shm_w.c
[pingz@localhost code]$ gcc -g -c shm_w.o shm_w.c 
gcc: 错误：shm_w.o：没有那个文件或目录
[pingz@localhost code]$ gcc -g -c  shm_w.c 
[pingz@localhost code]$ gcc -o  shm_w shm_w.
shm_w.c  shm_w.o  
[pingz@localhost code]$ gcc -o  shm_w shm_w.o
[pingz@localhost code]$ gdb ./shm_w
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-redhat-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /home/pingz/code/shm_w...done.
(gdb) l
14	
15	char* path = "./shared_data";
16	
17	int main()
18	{
19		SHARE_DATA *p_data;
20		int shmid;
21		FILE* fd;
22	
23		p_data = (SHARE_DATA*)calloc(1, sizeof(SHARE_DATA));
(gdb) 
24		if(!p_data)
25		{
26			printf("malloc failed.\n");
27			return -1;
28		}
29		p_data->count = 123;
30		p_data->size = 1000;
31		memset(&p_data->str, 0, 128);
32		strncpy(p_data->str, "data1", 5);
33		
(gdb) 
34		// 创建共享内存
35		shmid = shmget(ftok(path,'a'), sizeof(SHARE_DATA), IPC_CREAT|IPC_EXCL);
36		if (-1 == shmid)
37		{	
38		 	printf("shmget failed. %s\n", strerror(errno));
39		 	return -1;
40		}
41		
42		printf("create shard memeory success\n"); 						         fd = fopen(path, "w+");
43		if (NULL == fd)
(gdb) b 36
Breakpoint 1 at 0x4008dc: file shm_w.c, line 36.
(gdb) r
Starting program: /home/pingz/code/./shm_w 

Breakpoint 1, main () at shm_w.c:36
36		if (-1 == shmid)
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64
(gdb) p shmid
$1 = 229379
(gdb) n
42		printf("create shard memeory success\n"); 						         fd = fopen(path, "w+");
(gdb) p paht
No symbol "paht" in current context.
(gdb) p path
$2 = 0x400a40 "./shared_data"
(gdb) n
create shard memeory success
43		if (NULL == fd)
(gdb) 
47		fwrite(&shmid, 1, sizeof(int), fd);
(gdb) 
48		p_data = shmat(shmid,NULL,0);
(gdb) p p_data
$3 = (SHARE_DATA *) 0x602010
(gdb) p p_data->num
There is no member named num.
(gdb) p p_data->size
$4 = 1000
(gdb) p p_data->str
$5 = "data1", '\000' <repeats 122 times>
(gdb) q
A debugging session is active.

	Inferior 1 [process 16474] will be killed.

Quit anyway? (y or n) y
[pingz@localhost code]$ ll
总用量 96
drwxrwxr-x. 4 pingz pingz    39 6月  24 23:36 fa
-rw-rw-r--. 1 pingz pingz    45 6月  24 23:37 fa.tar.gz
-rwxrwxr-x. 1 pingz pingz 10520 7月  14 22:24 hash
-rw-rw-r--. 1 pingz pingz  1943 7月  14 22:24 hash.c
-rw-rw-r--. 1 pingz pingz  6272 7月  14 22:24 hash.o
-rwxrwxr-x. 1 pingz pingz  9056 7月   7 15:15 main
-rw-------. 1 pingz pingz  1420 7月   7 15:15 main.c
-rwxrwxr-x. 1 pingz pingz 11408 6月  23 16:22 multithread
-rw-rw-r--. 1 pingz pingz  1188 6月  23 16:22 multithread.c
-rw-rw-r--. 1 pingz pingz  7624 6月  23 16:22 multithread.o
-rwxrwxr-x. 1 pingz pingz   190 6月  24 23:33 package.sh
-rw-rw-r--. 1 pingz pingz     0 7月  21 00:09 shared_data
-rwxrwxr-x. 1 pingz pingz 11520 7月  21 00:08 shm_w
-rw-rw-r--. 1 pingz pingz  1011 7月  21 00:04 shm_w.c
-rw-rw-r--. 1 pingz pingz  7336 7月  21 00:08 shm_w.o
[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ gcc -g -c  shm_w.c 
[pingz@localhost code]$ gcc -o  shm_w shm_w.o
[pingz@localhost code]$ ./shm_w
shmget failed. File exists
[pingz@localhost code]$ ipcs -m

------------ 共享内存段 --------------
键        shmid      拥有者  权限     字节     nattch     状态      
0x00000000 65536      gdm        777        16384      1          目标       
0x00000000 163841     gdm        777        3932160    2          目标       
0xffffffff 196610     pingz      0          136        0                       
0x61004889 229379     pingz      0          136        0                       

[pingz@localhost code]$ ipcrm -m 229379
[pingz@localhost code]$ ipcrm -m 196610
[pingz@localhost code]$ ipcs -m

------------ 共享内存段 --------------
键        shmid      拥有者  权限     字节     nattch     状态      
0x00000000 65536      gdm        777        16384      1          目标       
0x00000000 163841     gdm        777        3932160    2          目标       

[pingz@localhost code]$ ./shm_w 
create shard memeory success
[pingz@localhost code]$ ll
总用量 100
drwxrwxr-x. 4 pingz pingz    39 6月  24 23:36 fa
-rw-rw-r--. 1 pingz pingz    45 6月  24 23:37 fa.tar.gz
-rwxrwxr-x. 1 pingz pingz 10520 7月  14 22:24 hash
-rw-rw-r--. 1 pingz pingz  1943 7月  14 22:24 hash.c
-rw-rw-r--. 1 pingz pingz  6272 7月  14 22:24 hash.o
-rwxrwxr-x. 1 pingz pingz  9056 7月   7 15:15 main
-rw-------. 1 pingz pingz  1420 7月   7 15:15 main.c
-rwxrwxr-x. 1 pingz pingz 11408 6月  23 16:22 multithread
-rw-rw-r--. 1 pingz pingz  1188 6月  23 16:22 multithread.c
-rw-rw-r--. 1 pingz pingz  7624 6月  23 16:22 multithread.o
-rwxrwxr-x. 1 pingz pingz   190 6月  24 23:33 package.sh
-rw-rw-r--. 1 pingz pingz     4 7月  21 00:17 shared_data
-rwxrwxr-x. 1 pingz pingz 11520 7月  21 00:13 shm_w
-rw-rw-r--. 1 pingz pingz  1011 7月  21 00:12 shm_w.c
-rw-rw-r--. 1 pingz pingz  7336 7月  21 00:13 shm_w.o
[pingz@localhost code]$ cat shared_data 
[pingz@localhost code]$ vim shared_data 
[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ gcc -g -c  shm_w.c 
[pingz@localhost code]$ gcc -o  shm_w shm_w.o
[pingz@localhost code]$ gdb ,.shm_w
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-redhat-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
,.shm_w: 没有那个文件或目录.
(gdb) l
No symbol table is loaded.  Use the "file" command.
(gdb) l
No symbol table is loaded.  Use the "file" command.
(gdb) q
[pingz@localhost code]$ gdb ./shm_w
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-redhat-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /home/pingz/code/shm_w...done.
(gdb) l
13	}SHARE_DATA;
14	
15	char* path = "./shared_data";
16	
17	int main()
18	{
19		SHARE_DATA *p_data;
20		int shmid;
21		FILE* fd;
22		int len = 0;
(gdb) 
23	
24		p_data = (SHARE_DATA*)calloc(1, sizeof(SHARE_DATA));
25		if(!p_data)
26		{
27			printf("malloc failed.\n");
28			return -1;
29		}
30		p_data->count = 123;
31		p_data->size = 1000;
32		memset(&p_data->str, 0, 128);
(gdb) 
33		strncpy(p_data->str, "data1", 5);
34		
35		// 创建共享内存
36		shmid = shmget(ftok(path,'a'), sizeof(SHARE_DATA), IPC_CREAT|IPC_EXCL);
37		if (-1 == shmid)
38		{	
39		 	printf("shmget failed. %s\n", strerror(errno));
40		 	return -1;
41		}
42		
(gdb) 
43		printf("create shard memeory success\n"); 						         fd = fopen(path, "w+");
44		if (NULL == fd)
45			printf("open file %s failed. %s\n", path, strerror(errno));
46	
47		// 把shmid写入文件
48		len = fwrite(&shmid, sizeof(int), 1, fd);
49		fclose(fd);
50	
51		p_data = shmat(shmid,NULL,0);
52		
(gdb) 
53		// 解除映射
54		shmdt(p_data);
55		
56		return 0;
57	}
(gdb) q
[pingz@localhost code]$ ipcs -m

------------ 共享内存段 --------------
键        shmid      拥有者  权限     字节     nattch     状态      
0x00000000 65536      gdm        777        16384      1          目标       
0x00000000 163841     gdm        777        3932160    2          目标       
0x61004889 262146     pingz      0          136        0                       

[pingz@localhost code]$ ipcrm -m 262146
[pingz@localhost code]$ ipcs -m

------------ 共享内存段 --------------
键        shmid      拥有者  权限     字节     nattch     状态      
0x00000000 65536      gdm        777        16384      1          目标       
0x00000000 163841     gdm        777        3932160    2          目标       

[pingz@localhost code]$ gcc -g -c  shm_w.c 
[pingz@localhost code]$ gcc -o  shm_w shm_w.o
[pingz@localhost code]$ gdb ./shm_w
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-redhat-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /home/pingz/code/shm_w...done.
(gdb) l
13	}SHARE_DATA;
14	
15	char* path = "./shared_data";
16	
17	int main()
18	{
19		SHARE_DATA *p_data;
20		int shmid;
21		FILE* fd;
22		int len = 0;
(gdb) 
23	
24		p_data = (SHARE_DATA*)calloc(1, sizeof(SHARE_DATA));
25		if(!p_data)
26		{
27			printf("malloc failed.\n");
28			return -1;
29		}
30		p_data->count = 123;
31		p_data->size = 1000;
32		memset(&p_data->str, 0, 128);
(gdb) 
33		strncpy(p_data->str, "data1", 5);
34		
35		// 创建共享内存
36		shmid = shmget(ftok(path,'a'), sizeof(SHARE_DATA), IPC_CREAT|IPC_EXCL);
37		if (-1 == shmid)
38		{	
39		 	printf("shmget failed. %s\n", strerror(errno));
40		 	return -1;
41		}
42		
(gdb) 
43		printf("create shard memeory success\n"); 						         fd = fopen(path, "w+");
44		if (NULL == fd)
45			printf("open file %s failed. %s\n", path, strerror(errno));
46	
47		// 把shmid写入文件
48		len = fwrite(&shmid, sizeof(int), 1, fd);
49		fclose(fd);
50	
51		p_data = shmat(shmid,NULL,0);
52		
(gdb) b 48
Breakpoint 1 at 0x4009b8: file shm_w.c, line 48.
(gdb) r
Starting program: /home/pingz/code/./shm_w 
create shard memeory success

Breakpoint 1, main () at shm_w.c:48
48		len = fwrite(&shmid, sizeof(int), 1, fd);
Missing separate debuginfos, use: debuginfo-install glibc-2.17-260.el7.x86_64
(gdb) p shmid 
$1 = 294914
(gdb) n
49		fclose(fd);
(gdb) p len
$2 = 1
(gdb) q
A debugging session is active.

	Inferior 1 [process 16966] will be killed.

Quit anyway? (y or n) y
[pingz@localhost code]$ ipcs -m

------------ 共享内存段 --------------
键        shmid      拥有者  权限     字节     nattch     状态      
0x00000000 65536      gdm        777        16384      1          目标       
0x00000000 163841     gdm        777        3932160    2          目标       
0x61004889 294914     pingz      0          136        0                       

[pingz@localhost code]$ ipcrm -m 294914
[pingz@localhost code]$ ipcs -m

------------ 共享内存段 --------------
键        shmid      拥有者  权限     字节     nattch     状态      
0x00000000 65536      gdm        777        16384      1          目标       
0x00000000 163841     gdm        777        3932160    2          目标       

[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ gcc -g -c  shm_w.c 
shm_w.c: 在函数‘main’中:
shm_w.c:50:2: 错误：expected ‘;’ before ‘fclose’
  fclose(fd);
  ^
[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ gcc -g -c  shm_w.c 
shm_w.c: 在函数‘main’中:
shm_w.c:49:24: 错误：expected ‘)’ before ‘;’ token
  fprintf(fd,"%d", shmid;)
                        ^
shm_w.c:50:2: 错误：expected ‘;’ before ‘fclose’
  fclose(fd);
  ^
[pingz@localhost code]$ vim shm_w.c
[pingz@localhost code]$ gcc -g -c  shm_w.c 
[pingz@localhost code]$ gcc -o  shm_w shm_w.o
[pingz@localhost code]$ ./shm_w 
create shard memeory success
[pingz@localhost code]$ ll
总用量 100
drwxrwxr-x. 4 pingz pingz    39 6月  24 23:36 fa
-rw-rw-r--. 1 pingz pingz    45 6月  24 23:37 fa.tar.gz
-rwxrwxr-x. 1 pingz pingz 10520 7月  14 22:24 hash
-rw-rw-r--. 1 pingz pingz  1943 7月  14 22:24 hash.c
-rw-rw-r--. 1 pingz pingz  6272 7月  14 22:24 hash.o
-rwxrwxr-x. 1 pingz pingz  9056 7月   7 15:15 main
-rw-------. 1 pingz pingz  1420 7月   7 15:15 main.c
-rwxrwxr-x. 1 pingz pingz 11408 6月  23 16:22 multithread
-rw-rw-r--. 1 pingz pingz  1188 6月  23 16:22 multithread.c
-rw-rw-r--. 1 pingz pingz  7624 6月  23 16:22 multithread.o
-rwxrwxr-x. 1 pingz pingz   190 6月  24 23:33 package.sh
-rw-rw-r--. 1 pingz pingz     6 7月  21 00:47 shared_data
-rwxrwxr-x. 1 pingz pingz 11568 7月  21 00:47 shm_w
-rw-rw-r--. 1 pingz pingz  1073 7月  21 00:46 shm_w.c
-rw-rw-r--. 1 pingz pingz  7448 7月  21 00:46 shm_w.o
[pingz@localhost code]$ cat shared_data 
327682[pingz@localhost code]$ ll
总用量 100
drwxrwxr-x. 4 pingz pingz    39 6月  24 23:36 fa
-rw-rw-r--. 1 pingz pingz    45 6月  24 23:37 fa.tar.gz
-rwxrwxr-x. 1 pingz pingz 10520 7月  14 22:24 hash
-rw-rw-r--. 1 pingz pingz  1943 7月  14 22:24 hash.c
-rw-rw-r--. 1 pingz pingz  6272 7月  14 22:24 hash.o
-rwxrwxr-x. 1 pingz pingz  9056 7月   7 15:15 main
-rw-------. 1 pingz pingz  1420 7月   7 15:15 main.c
-rwxrwxr-x. 1 pingz pingz 11408 6月  23 16:22 multithread
-rw-rw-r--. 1 pingz pingz  1188 6月  23 16:22 multithread.c
-rw-rw-r--. 1 pingz pingz  7624 6月  23 16:22 multithread.o
-rwxrwxr-x. 1 pingz pingz   190 6月  24 23:33 package.sh
-rw-rw-r--. 1 pingz pingz     6 7月  21 00:47 shared_data
-rwxrwxr-x. 1 pingz pingz 11568 7月  21 00:47 shm_w
-rw-rw-r--. 1 pingz pingz  1073 7月  21 00:46 shm_w.c
-rw-rw-r--. 1 pingz pingz  7448 7月  21 00:46 shm_w.o
[pingz@localhost code]$ ipcs -m

------------ 共享内存段 --------------
键        shmid      拥有者  权限     字节     nattch     状态      
0x00000000 65536      gdm        777        16384      1          目标       
0x00000000 163841     gdm        777        3932160    2          目标       
0x61004889 327682     pingz      0          136        0                       

[pingz@localhost code]$ vim shm_w.c

 30         p_data->count = 123; 
 31         p_data->size = 1000; 
 32         memset(&p_data->str, 0, 128); 
 33         strncpy(p_data->str, "data1", 5); 
 34          
 35         // 创建共享内存 
 36         shmid = shmget(ftok(path,'a'), sizeof(SHARE_DATA), IPC_CREAT|IPC_EXCL); 
 37         if (-1 == shmid) 
 38         {        
 39                 printf("shmget failed. %s\n", strerror(errno)); 
 40                 return -1; 
 41         } 
 42          
 43         printf("create shard memeory success\n");
 	    fd = fopen(path, "w+"); 
 44         if (NULL == fd) 
 45                 printf("open file %s failed. %s\n", path, strerror(errno)); 
 46  
 47         // 把shmid写入文件 
 48         //len = fwrite(&shmid, sizeof(int), 1, fd);  //fwrite写入文件是二进制流
 49         fprintf(fd,"%d", shmid); // 写入的内容直接可理解
 50         fclose(fd); 
 51  
 52         p_data = shmat(shmid,NULL,0); 
 53          
 54         // 解除映射 
 55         shmdt(p_data); 
 56          
 57         return 0; 
 58 }
-- 可视 --                                                                               58,1         底端


```
